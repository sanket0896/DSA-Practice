/**
 * Ath largest element
Problem Description
Given an integer array B of size N. You need to find the Ath largest element in the subarray [1 to i] where i varies from 1 to N. In other words, find the Ath largest element in the sub-arrays [1 : 1], [1 : 2], [1 : 3], ...., [1 : N]. NOTE: If any subarray [1 : i] has less than A elements then output array should be -1 at the ith index.   


Problem Constraints
1 <= N <= 100000
1 <= A <= N
1 <= B[i] <= INT_MAX


Input Format
First argument is an integer A.
Second argument is an integer array B of size N.


Output Format
Return an integer array C, where C[i] (1 <= i <= N) will have the Ath largest element in the subarray [1 : i].


Example Input
Input 1:
 A = 4  
 B = [1 2 3 4 5 6] 
Input 2:
 A = 2
 B = [15, 20, 99, 1]
  


Example Output
Output 1:
 [-1, -1, -1, 1, 2, 3]
Output 2:
 [-1, 15, 20, 20]
  


Example Explanation
Explanation 1:
 for i <= 3 output should be -1.
 for i = 4 , Subarray [1:4] has 4 elements 1, 2, 3 and 4. So, 4th maximum element is 1.
 for i = 5 , Subarray [1:5] has 5 elements 1, 2, 3, 4 and 5. So, 4th maximum element is 2.
 for i = 6 , Subarray [1:6] has 6 elements 1, 2, 3, 4, 5 and 6. So, 4th maximum element is 3.
 So, output array is [-1, -1, -1, 1, 2, 3].
 
Explanation 2:
 for i <= 1 output should be -1.
 for i = 2 , Subarray [1:2] has 2 elements 15 and 20. So, 2th maximum element is 15.
 for i = 3 , Subarray [1:3] has 3 elements 15, 20 and 99. So, 2th maximum element is 20.
 for i = 4 , Subarray [1:4] has 4 elements 15, 20, 99 and 1. So, 2th maximum element is 20.
 So, output array is [-1, 15, 20, 20].
  
 */

class CustomMinHeap{

    constructor(A){
        this._heap = A;  
        this.buildHeap();
    }

    buildHeap(){
        let si = Math.floor((this._heap.length - 2) / 2);

        for(let i = si; i >=0; --i){
            this.downHeapify(i);
        }
    }

    downHeapify(root){
        let al = this._heap.length;
        let min = root;
        let l = root * 2 + 1;
        let r = root * 2 + 2;

        if(l < al && this._heap[l] < this._heap[min]){
            min = l;
        }

        if(r < al && this._heap[r] < this._heap[min]){
            min = r;
        }

        if(min !== root){
            this.swap(min, root);
            this.downHeapify(min);
        }
    }

    upHeapify(node){
        if(node === 0){
            return;
        }

        let parent = Math.floor((node - 1) / 2);

        if(node < this._heap.length && this._heap[node] < this._heap[parent]){
            this.swap(node, parent);
            this.upHeapify(parent);
        }
    }

    swap(i, j){
        const t = this._heap[i];
        this._heap[i] = this._heap[j];
        this._heap[j] = t;
    }

    peek(){
        if(!this.isEmpty()){
            return this._heap[0];
        }
    }

    remove(){
        if(!this.isEmpty()){
            let ret = this._heap[0];
            this._heap[0] = this._heap[this._heap.length - 1];
            this._heap.pop();            
            this.downHeapify(0);
            return ret;
        }
    }

    add(elem){
        this._heap.push(elem);
        this.upHeapify(this._heap.length - 1);
    }

    isEmpty(){
        return this._heap.length <= 0;
    }

    size(){
        return this._heap.length;
    }
}

function solve(B, A) {
    let al = A.length;
    let ans = new Array(al).fill(-1);

    if(B <= al){
        let heap = new CustomMinHeap(A.slice(0,B));
        ans[B-1] = heap.peek();

        for(let i = B; i < al; ++i){
            if(A[i] > ans[i-1]){
                heap.remove();
                heap.add(A[i]);
            }
            ans[i] = heap.peek();
        }
    }

    return ans;
}

A = 14165
B = [ 778035002, 117275774, 558176013, 702388931, 321742953, 655797141, 687741670, 868487925, 798687544, 119024091, 263411537, 45146753, 749430161, 929855306, 320580370, 36625764, 622911550, 550806821, 707169982, 554442311, 231311130, 545908361, 344243913, 176423720, 650310418, 929958276, 109472607, 991747889, 69356392, 276993764, 280278406, 699907746, 246785890, 838454419, 254813029, 568528843, 346767913, 942554699, 437016768, 997971809, 61578790, 552944658, 895634914, 663525304, 335316316, 68731637, 700151068, 958227867, 619538458, 259837402, 365186530, 703365940, 658262115, 709430443, 879789660, 161088886, 491905071, 989262268, 152836775, 413777815, 118772384, 433115181, 113685562, 365558274, 124085953, 221014943, 934087117, 323370218, 16085995, 223620238, 321342027, 77664785, 776564896, 69493294, 593706441, 111881212, 138224931, 146373861, 922625431, 757763389, 258727615, 140328313, 313645681, 916989731, 849758756, 45951694, 78078617, 341663828, 35213962, 83431744, 755441643, 6502698, 516546925, 721643557, 224577324, 493149230, 942658501, 11180793, 816519448, 958744496, 234801031, 137861476, 888925633, 863882279, 59871122, 335148427, 828279844, 198096053, 334038640, 603421627, 955859442, 592766256, 743749941, 122021475, 509755987, 593508697, 167973169, 440350956, 787688877, 55703483, 523782700, 395646873, 62206181, 40329625, 117290430, 286783505, 385995208, 912465283, 297964299, 202514656, 723726131, 385281682, 192892484, 465168117, 249163962, 252763606, 652832896, 77443806, 450859659, 986871536, 533381785, 259235453, 579637792, 277131726, 381256929, 941910131, 723156776, 549230098, 382261087, 510845653, 604933582, 906043787, 906492526, 519656115, 798889765, 876299309, 806439621, 37401325, 641280944, 956920272, 239915981, 217523428, 342201954, 285324818, 535207897, 443882268, 538088424, 188040793, 373842426, 841464436, 27428681, 907224212, 100699889, 607066474, 36872290, 334473170, 401492957, 760029066, 736219621, 783754045, 123391072, 193669555, 542314184, 29883598, 713325670, 193720301, 758699259, 372281643, 231121626, 252496556, 329201915, 323553960, 322536336, 523920222, 608878778, 857744233, 967802490, 146967202, 45785026, 341644917, 840947990, 73213707, 101385481, 794164232, 532796533, 138257771, 128637402, 934289491, 898286838, 717373375, 570559888, 21677910, 911042930, 965390424, 904077860, 624368601, 11627078, 515293472, 996650244, 242748704, 767790028, 178368512, 566302664, 90326364, 702288734, 27697794, 800586949, 522607576, 27181349, 698888327, 864252493, 868129339, 624618386, 965637974, 662293571, 9931272, 103895746, 643447326, 944220763, 854698936, 213337053, 367297003, 876376846, 124379984, 185203779, 632971058, 601264937, 196830857, 148264530, 450431533, 439579562, 768570910, 628800045, 858398578, 711413626, 183605131, 886096373, 512000575, 706212708, 913277722, 63405254, 422981553, 781407061, 688023641, 241135880, 296216985, 697954913, 197547978, 792180663, 494692028, 52246914, 5517716, 861989031, 781140112, 129897700, 47192810, 266627522, 583678989, 96540020, 414892053, 34110523, 536119582, 35979315, 515426920, 247034512, 747392942, 699032052, 133130885, 111909869, 257761112, 46408607, 175315124, 533259017, 680332021, 863338765, 774394897, 829065358, 561293678, 824459227, 621246021, 55985706, 729222493, 479280089, 770491089, 362878957, 461694142, 670200251, 629506480, 45373131, 766740271, 44398533, 79483654, 155376205, 80377848, 447426927, 402410718, 680287142, 146458979, 388057955, 792197012, 256736443, 286982915, 967512136, 789995460, 967314936, 830850901, 416906710, 648896646, 244660931, 93882289, 122659019, 153162989, 823104783, 601939108, 776170430, 185983740, 63633250, 298887033, 815490220, 109006382, 65627305, 712405105, 41006388, 73519862, 645299306, 340949667, 328446932, 178102800, 339924998, 716504888, 970299812, 596661441, 3487803, 937811948, 239173254, 823319091, 621179201, 508596316, 472215737, 718356484, 602478605, 594874756, 871519473, 425583388, 49330216, 500206255, 464083481, 112963467, 799093289, 132090053, 74486201, 717236946, 844495159, 968008941, 790756808, 342310817, 308958609, 119203741, 520413617, 648883607, 688224981, 343229782, 98061401, 691712784, 133558082, 189751007, 367548227, 754737284, 698347323, 839763964, 325610120, 300825928, 287155072, 49645946, 578925669, 336485288, 549852201, 43009150, 301965107, 348945490, 175099203, 376451308, 66182436, 872110714, 196976602, 709455597, 66937883, 505935211, 681175690, 587351501, 7335170, 221917023, 930581283, 105396571, 913629807, 64139365, 147663930, 133694386, 671393001, 846011253, 973458350, 997003122, 146837182, 113129774, 46649068, 578279203, 302131414, 449017621, 621288353, 604096522, 797963112, 648903908, 980547830, 716661900, 521014623, 30040784, 278633849, 587952506, 535975995, 812325891, 27820359, 395827518, 34242914, 810917994, 353740441, 800389073, 727573712, 501404372, 934083459, 251483065, 347415625, 760058161, 101002539, 346769159, 873187935, 167959, 925048362, 27835702, 449185581, 398853067, 631932224, 99665045, 47756976, 464996406, 816326945, 421287951, 495037191, 947477147, 861756809, 31013186, 759803038, 889577169, 279357056, 646562305, 553011515, 633097498, 446951378, 280585227, 134501870, 233551190, 532068293, 334433847, 993609351, 633070832, 681203007, 719313639, 633238792, 458767721, 747149341, 82424373, 710137141, 379081565, 34605770, 610410469, 844077971, 850932715, 31698420, 191631514, 650926214, 745971581, 75161053, 263245605, 488065102, 354518109, 909807910, 41076618, 987615607, 209275640, 174178197, 122117477, 442826830, 706246490, 309067677, 436436182, 191833675, 990270684, 8266173, 677588819, 301554757, 755415514, 612529544, 11691898, 134497079, 647135314, 474618719, 831091402, 350584381, 358833491, 22722917, 1510596, 104805073, 97883970, 264756201, 592870175, 304918431, 27080463, 486463145, 292534039, 236356103, 660641343, 267167868, 679182934, 219404185, 576235545, 115619116, 411237860, 419022581, 123885289, 88826679, 573093691, 731817155, 553872575, 437301941, 718830586, 201007889, 911920661, 402438340, 551592271, 270754152, 277677609, 405619219, 228075577, 228077931, 670375420, 820945753, 532996363, 697455883, 159925250, 825530402, 933811986, 820566593, 945214622, 465511272, 39970779, 373966520, 433646740, 303724991, 792989101, 410048381, 245068023, 218599144, 141865536, 798940598, 655901086, 860696122, 999948488, 567821747, 115650815, 404057111, 691092251, 393328424, 809676330, 919167829, 621406356, 332568102, 592629934, 154402719, 882540337, 752555184, 832449473, 668868675, 573121778, 777664095, 134379948, 465608909, 4146967, 568026688, 769333900, 797136069, 978075070, 14401923, 15735213, 972456958, 813342522, 524152651, 685669433, 665807362, 91974398, 801320248, 922380825, 635583002, 194648672, 584573507, 554750831, 816055028, 917141609, 147380765, 822974099, 652198298, 752452301, 655423572, 321066973, 178090431, 285604020, 307963273, 643699340, 289750987, 875989962, 413033241, 939403408, 706581384, 279951516, 807654974, 531554694, 93294038, 331807625, 217224127, 611617752, 276298376, 18544375, 386514929, 911881378, 65709400, 971088436, 319148561, 734280780, 740746397, 319045678, 557254880, 392944695, 71497979, 65194804, 566528021, 102104763, 203315176, 874491294, 745804103, 493066164, 602997608, 11353696, 284985924, 162095344, 291305213, 92640898, 693650039, 237115603, 276964876, 910874166, 848733356, 553263252, 781934894, 87764637, 317660982, 700160646, 58853074, 489325895, 434441426, 799599471, 808371573, 844212658, 45060519, 732385904, 909407463, 611588540, 834490667, 112722639, 338596186, 432811123, 458305155, 941593795, 444164819, 743291080, 103689139, 735470032, 688448330, 797339178, 972585636, 965413206, 560729697, 673835344, 371192810, 195180943, 761599981, 688853792, 895341589, 820453055, 30696039, 182299367, 472568879, 839067612, 26512026, 370145750, 423969869, 788435841, 981734290, 110976888, 753674832, 172846828, 543788011, 64496340, 114440623, 987952831, 660303772, 70646115, 575939215, 348752102, 867985293, 548524851, 166681661, 281231342, 74876547, 537874471, 328928637, 836476529, 79244616, 76786578, 509445936, 109940655, 259085946, 982014815, 949008268, 138114324, 204676917, 225494489, 779066517, 38927559, 188987729, 385257701, 211774388, 732775741, 449754041, 326215011, 573244924, 110057813, 396861126, 1700491, 311326268, 117362772, 550225343, 478007929, 251110466, 625101890, 15882400, 580039104, 314094771, 95127016, 656825682, 823540708, 57584024, 915911628, 658071875, 6592292, 906542304, 862748793, 84603133, 685608821, 901676352, 273590862, 70866523, 113450740, 858882955, 373136916, 292182104, 284644231, 335711082, 689043230, 286344723, 499553702, 658922354, 836570066, 977561631, 910032821, 314188308, 845960383, 490071925, 628283080, 793603752, 146897607, 304340140, 851187776, 915325588, 962412015, 710296420, 674384244, 825160808, 647415905, 212509418, 579353513, 921006767, 135892293, 692804253, 632406075, 509029209, 984986357, 917050306, 697256643, 526545940, 203395029, 196810345, 37984646, 892481447, 26888328, 948017467, 59186108, 725365064, 290605744, 687469188, 371485168, 290019704, 991809328, 75189296, 57861644, 806737695, 785485716, 732245888, 484414856, 285417973, 944755306, 63768369, 58941092, 80647599, 609088974, 691347167, 442193161, 446591684, 608397474, 139449804, 973137624, 664308855, 188776502, 11122270, 556790303, 215664830, 811656090, 615976411, 941029894, 102261834, 155961951, 165031414, 392281538, 287631, 240220710, 450143182, 807025326, 25706426, 34905423, 143956534, 163640751, 979660729, 207724903, 222581844, 60308329, 816813878, 913929011, 355017842, 115921914, 374842837, 494467646, 89059538, 39151693, 683244148, 952698160, 448458348, 751425331, 616870602, 64434759, 544971577, 719132437, 72913062, 710002992, 963930327, 73200693, 950223702, 266589862, 732742371, 828446481, 301495285, 876698906, 992087232, 281156014, 936940161, 214669076, 193980695, 606270391, 128598088, 548998537, 722192305, 355957277, 895982536, 663768195, 395108970, 431743036, 468982708, 843567318, 183168367, 85853310, 760518429, 728139945, 657502099, 685947843, 290659289, 621432427, 611664888, 240882991, 888022289, 196923612, 69329472, 42033926, 73622518, 913933057, 323189940, 863079031, 128602133, 369686988, 469349423, 109716573, 918685525, 44058080, 318190203, 667184413, 707826276, 713299173, 98927450, 176808984, 409382844, 134612169, 115178646, 22417625, 862752114, 772680746, 708365469, 5927755, 246629525, 172546709, 246810747, 134651814, 369470321, 168656571, 29202092, 295609191, 82589628, 352392032, 158688223, 63708114, 722079020, 480553998, 25941039, 493280898, 524612078, 196647594, 12981663, 232438354, 909946768, 111909113, 261763690, 171845964, 246521283, 376942337, 46779941, 961789749, 149623083, 755145410, 967717505, 396252608, 927692120, 67044604, 383420774, 149678793, 235701175, 412622866, 445287985, 170807156, 617531250, 603976208, 87031622, 192126623, 84530206, 965489013, 685407521, 461658636, 162136608, 698389184, 694096991, 924599728,]

console.log(solve(A, B));
console.log(B.length);
